<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Student Dashboard - FitTracker</title>
    <link rel="stylesheet" href="new-styles.css">
    <link rel="icon" href="images/favicon.png" type="image/png">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Quill core CSS -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">



    <style>
        :root {
            --primary: #4CAF50;
            --secondary: #3e8e41;
            --success: #4CAF50;
            --danger: #f44336;
            --light: #f5f7fa;
            --dark: #2d3436;
            --gray: #95a5a6;
        }

        body {
            margin: 0;
            background-color: var(--light);
            font-family: 'Poppins', sans-serif;
            color: black;
        }

        .dashboard {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .navbar {
            background: white;
            padding: 1rem;
            display: flex;
            justify-content: center;
            gap: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .navbar a {
            color: var(--gray);
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 500;
            transition: all 0.3s;
            cursor: pointer;
            color: black;
        }

        .navbar a:hover,
        .navbar a.active {
            color: var(--primary);
            background: rgba(67, 97, 238, 0.1);
        }

        .content {
            flex: 1;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
        }

        .card {
            background: white;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            margin-bottom: 2rem;
        }

        h2 {
            color: var(--primary);
            margin-top: 0;
            margin-bottom: 1.5rem;
        }

        .card p {
         font-size: 16px;
          margin-bottom: 10px;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--dark);
        }

        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #e0e0e0;
            border-radius: 0.5rem;
            font-family: inherit;
            transition: all 0.3s;
            color: black;
        }

        select.form-control {
            color: #000;
            background-color: white;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%234CAF50' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 16px 12px;
            appearance: none;
        }

        select.form-control option {
            color: #000;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
        }

        .btn {
            padding: 0.75rem 1.5rem;
            background: var(--primary);
            color: black;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn:hover {
            background: var(--secondary);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }
        
        thead {
          background-color: var(--primary);
        }

        thead th {
          color: white;
        }


        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #eee;
            color: black;
        }

        th {
            background: var(--primary);
            color: black;
        }

        tr:nth-child(even) {
            background: rgba(67, 97, 238, 0.05);
        }

        .filter-group {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .attendance-summary {
            margin-top: 1rem;
            font-weight: 600;
            color: var(--primary);
            background-color: #e0f7e9;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
            animation: fadeInSlide 1s ease forwards;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            text-align: center;
            font-size: 1.1rem;
            font-weight: 700;
            letter-spacing: 0.05em;
            -webkit-user-select: none;
            user-select: none;
        }

        @keyframes fadeInSlide {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .btn {
            padding: 0.75rem 1.5rem;
            background: var(--primary);
            color: black;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.4s ease;
            box-shadow: 0 4px 8px rgba(76, 175, 80, 0.3);
        }

        .btn:hover {
            background: var(--secondary);
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(76, 175, 80, 0.5);
        }

        .navbar a {
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .navbar a:hover,
        .navbar a.active {
            color: var(--primary);
            background: rgba(67, 97, 238, 0.15);
            box-shadow: 0 4px 12px rgba(67, 97, 238, 0.3);
            transform: scale(1.05);
            border-radius: 8px;
        }
        .goal-ribbon {
            background: #4CAF50;
            color: white;
            text-align: center;
            padding: 12px 20px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 0 0 15px 15px;
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            letter-spacing: 1px;
        }

        .student-info {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            background: #f0f4f7;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            font-size: 18px;
        }

        .info-item {
            margin: 10px 20px;
            font-weight: bold;
            color: #2c3e50;
        }

        #attendanceTable {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        #attendanceTable th, #attendanceTable td {
            border: 1px solid #ccc;
            padding: 12px;
            text-align: center;
            font-size: 16px;
        }

        #attendanceTable th {
            background-color: #4CAF50;
            color: white;
        }

        .present {
            background-color: #d4edda; /* Green background */
            color: #155724;
        }

        .absent {
            background-color: #f8d7da; /* Red background */
            color: #721c24;
        }
        /* Disabled dropdown */
select:disabled {
    background-color: #f2f2f2; /* Light gray background */
    color: #888; /* Gray text */
    cursor: not-allowed; /* Change cursor to indicate no interaction */
    border: 1px solid #ccc; /* Subtle border */
}

/* Disabled submit button */
button:disabled {
    background-color: #ccc; /* Light gray button */
    color: #666; /* Darker gray text */
    cursor: not-allowed; /* Change cursor */
    border: 1px solid #ddd; /* Subtle border */
}
.machine-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 1rem;
    }
    .machine-card:hover {
  transform: scale(1.02);
  transition: all 0.2s ease-in-out;
  box-shadow: 0 0 10px rgba(0, 123, 255, 0.3);
  cursor: pointer;
}
.machine-img {
  background-color: #f1f1f1;
  height: 100px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #888;
  font-size: 0.9rem;
  border-radius: 8px;
}
.machine-card button {
        margin-top: 0.5rem;
        padding: 0.5rem 1rem;
        font-weight: bold;
    }

    .disabled {
        opacity: 0.5;
        pointer-events: none;
    }

.section-banner {
  width: 100%;
  text-align: center;
  padding: 1rem 0;
  font-size: 1.5rem;
  font-weight: 600;
  position: relative;
  margin: 2rem 0 1rem;
  color: white;
}

.section-banner::before,
.section-banner::after {
  content: "";
  position: absolute;
  top: 100%;
  border-style: solid;
  border-width: 0.5rem;
  border-color: transparent;
}

.section-banner::before {
  left: 0;
  border-left-color: rgba(0, 0, 0, 0.2);
}

.section-banner::after {
  right: 0;
  border-right-color: rgba(0, 0, 0, 0.2);
}

.styled-plan-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 10px;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 0 8px rgba(0, 0, 0, 0.1);
}

.styled-plan-table th, .styled-plan-table td {
  padding: 10px 14px;
  text-align: left;
  border-bottom: 1px solid #eee;
}

.styled-plan-table th {
  background-color: #37c8ed;
  font-weight: 600;
  color: #444;
}

.styled-plan-table tr:nth-child(even) {
  background-color: #fafafa;
}
   .planner {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 20px;
  max-width: 1000px;
  justify-content: center;
  margin: auto;
  padding: 0 15px;
}

.day-wrapper {
  display: flex;
  flex-direction: column;
  background: #f9f9f9;
  border-radius: 16px;
  padding: 15px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.05);
  transition: transform 0.2s ease-in-out;
}

.day-wrapper:hover {
  transform: translateY(-3px);
}

.day-name {
  font-weight: 600;
  font-size: 1.1rem;
  color: #333;
  margin-bottom: 8px;
}

.day-card {
  background: #fff;
  border: 2px solid #ddd;
  border-radius: 12px;
  padding: 12px;
  min-height: 140px;
  box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
  overflow-y: auto;
}

.day-card[contenteditable="true"]:focus {
  outline: none;
  border-color: #007bff;
  background: #f0f8ff;
}
#bodyPartTips img {
  border-radius: 8px;
  object-fit: cover;
}
.card-title {
  text-align: center;
  font-size: 1rem;
}



    </style>
</head>
<body>

    <header class="header">
        <div class="header-content">
            <h1>Welcome, <span id="studentName"></span>!</h1>
            <h2 id="welcomeText"></h2>
            <button onclick="logout()" class="btn" style="float:right;">Logout</button>
        </div>
    </header>

    <div class="goal-ribbon" id="studentGoal">
        <!-- Goal will come here -->
    </div>
    
    <div class="dashboard">
            <div class="navbar">
        <a href="#" class="active" id="planner-main">Workout Planner</a>
        <a href="#" id="tips-main">Tips</a>
        <a href="#" id="attendance-main">Attendance</a>
        <a href="#" id="logs-main">Training Logs</a>


      </div>
        <br>
       
    <section class="student-info" style="background-color: rgb(46, 162, 158)">
        <div class="info-item">Slot: <span id="studentSlot"></span></div>
        <div class="info-item">Darajah: <span id="studentDarajah"></span></div>
        <div class="info-item">TR: <span id="studentTR"></span></div>
        

    </section>


 <div class="content">

      <section class="card" id="planner-low">
  <h1 class="text-center mb-4">Weekly Workout Planner</h1>

  <div class="planner" >
    <div class="day-wrapper">
      <div class="day-name">Monday</div>
      <div class="day-card" contenteditable="true" data-day="Monday"></div>
    </div>
    <div class="day-wrapper">
      <div class="day-name">Tuesday</div>
      <div class="day-card" contenteditable="true" data-day="Tuesday"></div>
    </div>
    <div class="day-wrapper">
      <div class="day-name">Wednesday</div>
      <div class="day-card" contenteditable="true" data-day="Wednesday"></div>
    </div>
    <div class="day-wrapper">
      <div class="day-name">Thursday</div>
      <div class="day-card" contenteditable="true" data-day="Thursday"></div>
    </div>
    <div class="day-wrapper">
      <div class="day-name">Friday</div>
      <div class="day-card" contenteditable="true" data-day="Friday"></div>
    </div>
    <div class="day-wrapper">
      <div class="day-name">Saturday</div>
      <div class="day-card" contenteditable="true" data-day="Saturday"></div>
    </div>
    <div class="day-wrapper">
      <div class="day-name">Sunday</div>
      <div class="day-card" contenteditable="true" data-day="Sunday"></div>
    </div>
  </div>

  <div class="text-center mt-4">
    <button onclick="savePlan()" type="button" class="btn btn-primary me-2">Save</button>
    <button id="applyLastWeekBtn" onclick="applyLastWeeksPlan()" type="button" style="display: none;" class="btn btn-secondary">
      Apply Last Week’s Plan
    </button>
  </div>
</section>






    <section class="card" id="attendance-low" style="display: none;">
        <h2>Your Weekly Attendance</h2>
        <div class="form-group">
            <label for="weekSelect">Select Range</label>
            <select id="weekSelect" class="form-control" required>
                <option value="" disabled selected>Loading Weeks...</option>
              </select>          
            <button class="btn" onclick="loadAttendance()" style="margin-top: 0.5rem;">Load Attendance</button>
          </div>
    
       
    
        <table id="attendanceTable" style="margin-top: 1rem;">
            <thead>
              <tr>
                <th>Tr No</th>
                <th>Name</th>
                <th>Monday</th>
                <th>Tuesday</th>
                <th>Wednesday</th>
                <th>Thursday</th>
                <th>Friday</th>
                <th>Saturday</th>
                <th>Sunday</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
            
    <section>
       <label id="attendanceRate" style="font-weight: bold; margin-top: 1rem;"></label>
    
    </section>

    </section>





    <section class="card" id="logs-low" style="display: none;">
      <div id="student-plan-section" style="margin-top: 30px;">
        <h3>Your Training Records - Trainer Filled</h3>
        <table id="studentPlanTable" class="styled-plan-table">
          <thead>
            <tr>
              <th>Date</th>
              <th>Plan</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

    </section>


   

        <section class="card mt-4" id="tips-low" style="display: none;">
            <div class="container my-5">
    <h2 class="mb-4 text-center">🏋️‍♀️ Gym Workout List</h2>
    <div class="accordion" id="workoutAccordion">

      
    <!-- 🔁 CARDIO -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingCardio">
        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseCardio" aria-expanded="false" aria-controls="collapseCardio">
          🔁 Cardio (Fat burn & endurance)
        </button>
      </h2>
      <div id="collapseCardio" class="accordion-collapse collapse show" aria-labelledby="headingCardio" data-bs-parent="#workoutAccordion">
        <div class="accordion-body p-0">
          <table class="table table-bordered mb-0">
            <thead class="table-light">
              <tr><th>Exercise</th><th>Benefit</th><th>Link</th></tr>
            </thead>
            <tbody>
              <tr><td>Jump Rope</td><td>Improves coordination, burns calories</td><td><a href="https://www.youtube.com/watch?v=jZx1M4S-A94" target="_blank">Watch</a></td></tr>
              <tr><td>Running</td><td>Boosts stamina, burns fat</td><td><a href="https://www.youtube.com/watch?v=6U54IdQXGiI" target="_blank">Watch</a></td></tr>
              <tr><td>High Knees</td><td>Increases heart rate, strengthens legs</td><td><a href="https://www.youtube.com/watch?v=OAJ_J3EZkdY" target="_blank">Watch</a></td></tr>
              <tr><td>Mountain Climbers</td><td>Cardio + core strength</td><td><a href="https://www.youtube.com/watch?v=nmwgirgXLYM" target="_blank">Watch</a></td></tr>
              <tr><td>Jumping Jacks</td><td>Full-body warmup and cardio</td><td><a href="https://www.youtube.com/watch?v=c4DAnQ6DtF8" target="_blank">Watch</a></td></tr>
              <tr><td>Burpees</td><td>Explosive fat burning, endurance</td><td><a href="https://www.youtube.com/watch?v=TU8QYVW0gDU" target="_blank">Watch</a></td></tr>
              <tr><td>Cycling</td><td>Leg strength and endurance</td><td><a href="https://www.youtube.com/watch?v=rpoOTG9cfwk" target="_blank">Watch</a></td></tr>
              <tr><td>Rowing Machine</td><td>Full-body cardio workout</td><td><a href="https://www.youtube.com/watch?v=eqVmMd7FdAA" target="_blank">Watch</a></td></tr>
              <tr><td>Shadow Boxing</td><td>Improves reflexes, cardio</td><td><a href="https://www.youtube.com/watch?v=ZbR-LAaZZ-k" target="_blank">Watch</a></td></tr>
              <tr><td>Stair Climbing</td><td>Glute & cardio strengthening</td><td><a href="https://www.youtube.com/watch?v=U4s4mEQ5VqU" target="_blank">Watch</a></td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- 💪 CHEST -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingChest">
        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseChest" aria-expanded="false" aria-controls="collapseChest">
          💪 Chest (Pecs, pressing power)
        </button>
      </h2>
      <div id="collapseChest" class="accordion-collapse collapse" aria-labelledby="headingChest" data-bs-parent="#workoutAccordion">
        <div class="accordion-body p-0">
          <table class="table table-bordered mb-0">
            <thead class="table-light">
              <tr><th>Exercise</th><th>Benefit</th><th>Link</th></tr>
            </thead>
            <tbody>
              <tr><td>Barbell Bench Press</td><td>Builds overall chest strength</td><td><a href="https://www.youtube.com/watch?v=rT7DgCr-3pg" target="_blank">Watch</a></td></tr>
              <tr><td>Dumbbell Bench Press</td><td>Improves balance and range</td><td><a href="https://www.youtube.com/watch?v=VmB1G1K7v94" target="_blank">Watch</a></td></tr>
              <tr><td>Incline Bench Press</td><td>Targets upper chest</td><td><a href="https://www.youtube.com/watch?v=SrqOu55lrYU" target="_blank">Watch</a></td></tr>
              <tr><td>Decline Bench Press</td><td>Focuses on lower chest</td><td><a href="https://www.youtube.com/watch?v=VmB1G1K7v94" target="_blank">Watch</a></td></tr>
              <tr><td>Push-Ups</td><td>Bodyweight chest exercise</td><td><a href="https://www.youtube.com/watch?v=IODxDxX7oi4" target="_blank">Watch</a></td></tr>
              <tr><td>Cable Chest Fly</td><td>Chest isolation with tension</td><td><a href="https://www.youtube.com/watch?v=eozdVDA78K0" target="_blank">Watch</a></td></tr>
              <tr><td>Dumbbell Fly</td><td>Stretches and isolates chest</td><td><a href="https://www.youtube.com/watch?v=eozdVDA78K0" target="_blank">Watch</a></td></tr>
              <tr><td>Chest Dips</td><td>Targets lower chest</td><td><a href="https://www.youtube.com/watch?v=2z8JmcrW-As" target="_blank">Watch</a></td></tr>
              <tr><td>Machine Press</td><td>Guided chest strength</td><td><a href="https://www.youtube.com/watch?v=8iPEnn-ltC8" target="_blank">Watch</a></td></tr>
              <tr><td>Plyo Push-Ups</td><td>Explosive chest power</td><td><a href="https://www.youtube.com/watch?v=QZEqB6wUPxQ" target="_blank">Watch</a></td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

             <!-- 🏋️‍♂️ Back -->
<div class="accordion-item">
  <h2 class="accordion-header" id="headingBack">
    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseBack" aria-expanded="false" aria-controls="collapseBack">
      🏋️‍♂️ Back (Lats, traps, posture)
    </button>
  </h2>
  <div id="collapseBack" class="accordion-collapse collapse" aria-labelledby="headingBack" data-bs-parent="#workoutAccordion">
    <div class="accordion-body p-0">
      <table class="table table-bordered mb-0">
        <thead class="table-light"><tr><th>Exercise</th><th>Benefit</th><th>Link</th></tr></thead>
        <tbody>
          <tr><td>Pull-Ups</td><td>Builds lats & upper back</td><td><a href="https://www.youtube.com/watch?v=eGo4IYlbE5g" target="_blank">Watch</a></td></tr>
          <tr><td>Chin-Ups</td><td>Targets biceps + back</td><td><a href="https://www.youtube.com/watch?v=b-ztMQPG4uk" target="_blank">Watch</a></td></tr>
          <tr><td>Lat Pulldown</td><td>Wider back development</td><td><a href="https://www.youtube.com/watch?v=CAwf7n6Luuc" target="_blank">Watch</a></td></tr>
          <tr><td>Barbell Bent-over Rows</td><td>Mid-back strength</td><td><a href="https://www.youtube.com/watch?v=vT2GjY_Umpw" target="_blank">Watch</a></td></tr>
          <tr><td>Dumbbell Rows</td><td>Single-lat focus</td><td><a href="https://www.youtube.com/watch?v=pYcpY20QaE8" target="_blank">Watch</a></td></tr>
          <tr><td>Deadlifts</td><td>Full posterior chain</td><td><a href="https://www.youtube.com/watch?v=op9kVnSso6Q" target="_blank">Watch</a></td></tr>
          <tr><td>Seated Cable Row</td><td>Mid-back isolation</td><td><a href="https://www.youtube.com/watch?v=IzoCF0PjV7k" target="_blank">Watch</a></td></tr>
          <tr><td>T-Bar Row</td><td>Thicker back development</td><td><a href="https://www.youtube.com/watch?v=UoC_O3HzsH0" target="_blank">Watch</a></td></tr>
          <tr><td>Inverted Rows</td><td>Bodyweight back exercise</td><td><a href="https://www.youtube.com/watch?v=5nC6J_W3D3g" target="_blank">Watch</a></td></tr>
          <tr><td>Face Pulls</td><td>Rear delts + posture</td><td><a href="https://www.youtube.com/watch?v=rep-qVOkqgk" target="_blank">Watch</a></td></tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- 🧱 Shoulders -->
<div class="accordion-item">
  <h2 class="accordion-header" id="headingShoulders">
    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseShoulders" aria-expanded="false" aria-controls="collapseShoulders">
      🧱 Shoulders (Delts)
    </button>
  </h2>
  <div id="collapseShoulders" class="accordion-collapse collapse" aria-labelledby="headingShoulders" data-bs-parent="#workoutAccordion">
    <div class="accordion-body p-0">
      <table class="table table-bordered mb-0">
        <thead class="table-light"><tr><th>Exercise</th><th>Benefit</th><th>Link</th></tr></thead>
        <tbody>
          <tr><td>Barbell Shoulder Press</td><td>Builds deltoid power</td><td><a href="https://www.youtube.com/watch?v=qEwKCR5JCog" target="_blank">Watch</a></td></tr>
          <tr><td>Dumbbell Shoulder Press</td><td>Improves shoulder stability</td><td><a href="https://www.youtube.com/watch?v=B-aVuyhvLHU" target="_blank">Watch</a></td></tr>
          <tr><td>Arnold Press</td><td>Front + side delt activation</td><td><a href="https://www.youtube.com/watch?v=vj2w851ZHRM" target="_blank">Watch</a></td></tr>
          <tr><td>Lateral Raises</td><td>Isolates side delts</td><td><a href="https://www.youtube.com/watch?v=3VcKaXpzqRo" target="_blank">Watch</a></td></tr>
          <tr><td>Front Raises</td><td>Targets front delts</td><td><a href="https://www.youtube.com/watch?v=-t7fuZ0KhDA" target="_blank">Watch</a></td></tr>
          <tr><td>Rear Delt Fly</td><td>Rear shoulder isolation</td><td><a href="https://www.youtube.com/watch?v=pZ53bA6vsfY" target="_blank">Watch</a></td></tr>
          <tr><td>Upright Row</td><td>Delts + traps</td><td><a href="https://www.youtube.com/watch?v=ja6tG3E5tD4" target="_blank">Watch</a></td></tr>
          <tr><td>Cable Lateral Raise</td><td>Continuous shoulder tension</td><td><a href="https://www.youtube.com/watch?v=ZgVZ0SBngU8" target="_blank">Watch</a></td></tr>
          <tr><td>Pike Push-Ups</td><td>Bodyweight shoulder press</td><td><a href="https://www.youtube.com/watch?v=HUMBmCZ3wJw" target="_blank">Watch</a></td></tr>
          <tr><td>Shrugs</td><td>Strengthens traps</td><td><a href="https://www.youtube.com/watch?v=UO2I7t6s3YI" target="_blank">Watch</a></td></tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="accordion-item">
  <h2 class="accordion-header" id="headingBiceps">
    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseBiceps" aria-expanded="false" aria-controls="collapseBiceps">
      💪 Biceps (Curl strength)
    </button>
  </h2>
  <div id="collapseBiceps" class="accordion-collapse collapse" aria-labelledby="headingBiceps" data-bs-parent="#workoutAccordion">
    <div class="accordion-body p-0">
      <table class="table table-bordered mb-0">
        <thead class="table-light">
          <tr><th>Exercise</th><th>Benefit</th><th>Video</th></tr>
        </thead>
        <tbody>
          <tr><td>Barbell Curl</td><td>Builds overall biceps</td><td><a href="https://www.youtube.com/watch?v=kwG2ipFRgfo" target="_blank">Watch</a></td></tr>
          <tr><td>Dumbbell Curl</td><td>Isolated arm strength</td><td><a href="https://www.youtube.com/watch?v=av7-8igSXTs" target="_blank">Watch</a></td></tr>
          <tr><td>Hammer Curl</td><td>Brachialis + forearm</td><td><a href="https://www.youtube.com/watch?v=zC3nLlEvin4" target="_blank">Watch</a></td></tr>
          <tr><td>Concentration Curl</td><td>Peak biceps focus</td><td><a href="https://www.youtube.com/watch?v=soxrZlIl35U" target="_blank">Watch</a></td></tr>
          <tr><td>Preacher Curl</td><td>Strict form biceps</td><td><a href="https://www.youtube.com/watch?v=FBA8wDbIebg" target="_blank">Watch</a></td></tr>
          <tr><td>Incline Dumbbell Curl</td><td>Stretches long head</td><td><a href="https://www.youtube.com/watch?v=8CPhB6wjzDw" target="_blank">Watch</a></td></tr>
          <tr><td>Cable Curl</td><td>Constant tension</td><td><a href="https://www.youtube.com/watch?v=IXRQxREu6xE" target="_blank">Watch</a></td></tr>
          <tr><td>Spider Curl</td><td>Isolates biceps top</td><td><a href="https://www.youtube.com/watch?v=1Xzy-6DR4UQ" target="_blank">Watch</a></td></tr>
          <tr><td>Zottman Curl</td><td>Full bicep + forearm</td><td><a href="https://www.youtube.com/watch?v=0nShYyujv-8" target="_blank">Watch</a></td></tr>
          <tr><td>Resistance Band Curl</td><td>Portable bicep training</td><td><a href="https://www.youtube.com/watch?v=_pSdyxKLMWc" target="_blank">Watch</a></td></tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="accordion-item">
  <h2 class="accordion-header" id="headingTriceps">
    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTriceps" aria-expanded="false" aria-controls="collapseTriceps">
      💪 Triceps (Arm power)
    </button>
  </h2>
  <div id="collapseTriceps" class="accordion-collapse collapse" aria-labelledby="headingTriceps" data-bs-parent="#workoutAccordion">
    <div class="accordion-body p-0">
      <table class="table table-bordered mb-0">
        <thead class="table-light">
          <tr><th>Exercise</th><th>Benefit</th><th>Video</th></tr>
        </thead>
        <tbody>
          <tr><td>Triceps Pushdown</td><td>Isolation for triceps</td><td><a href="https://www.youtube.com/watch?v=vB5OHsJ3EME" target="_blank">Watch</a></td></tr>
          <tr><td>Overhead Triceps Extension</td><td>Targets long head</td><td><a href="https://www.youtube.com/watch?v=_gsUck-7M74" target="_blank">Watch</a></td></tr>
          <tr><td>Skull Crushers</td><td>Strong triceps bulk</td><td><a href="https://www.youtube.com/watch?v=d_KZxkY_0cM" target="_blank">Watch</a></td></tr>
          <tr><td>Close-Grip Bench Press</td><td>Chest + triceps combo</td><td><a href="https://www.youtube.com/watch?v=RMMjE7X15Ns" target="_blank">Watch</a></td></tr>
          <tr><td>Dips</td><td>Bodyweight triceps strength</td><td><a href="https://www.youtube.com/watch?v=2z8JmcrW-As" target="_blank">Watch</a></td></tr>
          <tr><td>Kickbacks</td><td>Finishing triceps burn</td><td><a href="https://www.youtube.com/watch?v=6SS0kF36Hqw" target="_blank">Watch</a></td></tr>
          <tr><td>Diamond Push-Ups</td><td>Bodyweight triceps</td><td><a href="https://www.youtube.com/watch?v=J0DnG1_S92I" target="_blank">Watch</a></td></tr>
          <tr><td>Rope Extensions</td><td>Outer triceps emphasis</td><td><a href="https://www.youtube.com/watch?v=7ANbjMGFahk" target="_blank">Watch</a></td></tr>
          <tr><td>Single-arm Overhead Cable Extension</td><td>Unilateral triceps</td><td><a href="https://www.youtube.com/watch?v=U2Vx3edTxp0" target="_blank">Watch</a></td></tr>
          <tr><td>Reverse Grip Pushdown</td><td>Focuses on medial head</td><td><a href="https://www.youtube.com/watch?v=ph0jyZ8z3pk" target="_blank">Watch</a></td></tr>
        </tbody>
      </table>
    </div>
  </div>
</div>


<div class="accordion-item">
  <h2 class="accordion-header" id="headingLegs">
    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseLegs" aria-expanded="false" aria-controls="collapseLegs">
      🦵 Legs (Glutes, quads, hamstrings, calves)
    </button>
  </h2>
  <div id="collapseLegs" class="accordion-collapse collapse" aria-labelledby="headingLegs" data-bs-parent="#workoutAccordion">
    <div class="accordion-body p-0">
      <table class="table table-bordered mb-0">
        <thead class="table-light">
          <tr>
            <th>Exercise</th>
            <th>Benefit</th>
            <th>Video</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Barbell Squat</td>
            <td>Overall leg mass + strength</td>
            <td><a href="https://www.youtube.com/watch?v=gcNh17Ckjgg" target="_blank">Watch</a></td>
          </tr>
          <tr>
            <td>Front Squat</td>
            <td>Quad-focused strength</td>
            <td><a href="https://www.youtube.com/watch?v=nmUof3vszxM" target="_blank">Watch</a></td>
          </tr>
          <tr>
            <td>Lunges</td>
            <td>Single-leg balance + strength</td>
            <td><a href="https://www.youtube.com/watch?v=fydLSJlGx-0" target="_blank">Watch</a></td>
          </tr>
          <tr>
            <td>Bulgarian Split Squat</td>
            <td>Intense unilateral leg power</td>
            <td><a href="https://www.youtube.com/watch?v=hiLF_pF3EJM" target="_blank">Watch</a></td>
          </tr>
          <tr>
            <td>Leg Press</td>
            <td>Leg strength with stability</td>
            <td><a href="https://www.youtube.com/watch?v=8vk6rWMSxOk" target="_blank">Watch</a></td>
          </tr>
          <tr>
            <td>Romanian Deadlift</td>
            <td>Hamstrings + glutes</td>
            <td><a href="https://www.youtube.com/watch?v=uhghy9pFIPY" target="_blank">Watch</a></td>
          </tr>
          <tr>
            <td>Calf Raise</td>
            <td>Targets calves</td>
            <td><a href="https://www.youtube.com/watch?v=UV8gOrHmuKc" target="_blank">Watch</a></td>
          </tr>
          <tr>
            <td>Leg Extension</td>
            <td>Isolates quads</td>
            <td><a href="https://www.youtube.com/watch?v=ljO4jkwv8wQ" target="_blank">Watch</a></td>
          </tr>
          <tr>
            <td>Hamstring Curl</td>
            <td>Isolates hamstrings</td>
            <td><a href="https://www.youtube.com/watch?v=swZQC689o9U" target="_blank">Watch</a></td>
          </tr>
          <tr>
            <td>Step-ups</td>
            <td>Leg + cardio combo</td>
            <td><a href="https://www.youtube.com/watch?v=ugW5I-a5A-Q" target="_blank">Watch</a></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>


<div class="accordion-item">
  <h2 class="accordion-header" id="headingCore">
    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseCore" aria-expanded="false" aria-controls="collapseCore">
      🔥 Core (Abs & stability)
    </button>
  </h2>
  <div id="collapseCore" class="accordion-collapse collapse" aria-labelledby="headingCore" data-bs-parent="#workoutAccordion">
    <div class="accordion-body p-0">
      <table class="table table-bordered mb-0">
        <thead class="table-light">
          <tr>
            <th>Exercise</th>
            <th>Benefit</th>
            <th>Video</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Plank</td>
            <td>Core endurance</td>
            <td><a href="https://www.youtube.com/watch?v=pSHjTRCQxIw" target="_blank">Watch</a></td>
          </tr>
          <tr>
            <td>Crunches</td>
            <td>Upper abs</td>
            <td><a href="https://www.youtube.com/watch?v=Xyd_fa5zoEU" target="_blank">Watch</a></td>
          </tr>
          <tr>
            <td>Leg Raises</td>
            <td>Lower abs</td>
            <td><a href="https://www.youtube.com/watch?v=JB2oyawG9KI" target="_blank">Watch</a></td>
          </tr>
          <tr>
            <td>Russian Twist</td>
            <td>Obliques & rotation</td>
            <td><a href="https://www.youtube.com/watch?v=wkD8rjkodUI" target="_blank">Watch</a></td>
          </tr>
          <tr>
            <td>Hanging Leg Raise</td>
            <td>Lower abs + grip</td>
            <td><a href="https://www.youtube.com/watch?v=2tM1LFFxeKg" target="_blank">Watch</a></td>
          </tr>
          <tr>
            <td>Bicycle Crunch</td>
            <td>Full core & cardio</td>
            <td><a href="https://www.youtube.com/watch?v=9FGilxCbdz8" target="_blank">Watch</a></td>
          </tr>
          <tr>
            <td>Mountain Climbers</td>
            <td>Core + cardio</td>
            <td><a href="https://www.youtube.com/watch?v=nmwgirgXLYM" target="_blank">Watch</a></td>
          </tr>
          <tr>
            <td>Cable Woodchopper</td>
            <td>Rotational strength</td>
            <td><a href="https://www.youtube.com/watch?v=2aEceax_be4" target="_blank">Watch</a></td>
          </tr>
          <tr>
            <td>V-ups</td>
            <td>Full abdominal contraction</td>
            <td><a href="https://www.youtube.com/watch?v=Q8Pz4xN0Z3g" target="_blank">Watch</a></td>
          </tr>
          <tr>
            <td>Side Plank</td>
            <td>Side abs + balance</td>
            <td><a href="https://www.youtube.com/watch?v=K2VljzCC16g" target="_blank">Watch</a></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

      

    </div>
  </div>

          

  <div style="margin-top: 20px;">
    <h2>Need guidance on specific body part workouts?</h2>
    <select id="bodyPartSelect" class="form-select" onchange="loadBodyPartTips()">
      <option value="">-- Select Body Part --</option>
      <option value="Cardio">Cardio</option>
      <option value="Chest">Chest</option>
      <option value="Back">Back</option>
      <option value="Shoulders">Shoulders</option>
      <option value="Biceps">Biceps</option>
      <option value="Triceps">Triceps</option>
      <option value="Legs">Legs</option>
      <option value="Core">Core</option>
    </select>
    <div id="bodyPartTips" class="mt-4"></div>
      <hr>
              <h2>Recommended Tip</h2>
        <div id="tipArea">Loading tip...</div>


  </div>

  
      </section>


</div>

  </div>  <footer class="footer" style="text-align: center;">
    <p>&copy; 2025 FitTracker. All rights reserved.</p>

<script>
let studentTR, studentName, branch, gender;

async function getStudentSession() {
  try {
    const res = await fetch('/api/student-session', {
      method: 'GET',
      credentials: 'include' // ✅ Include cookies
    });

    const data = await res.json();

    if (!data.success) {
      window.location.href = 'Forbidden.html';
      return;
    }

    const user = data.user;
    studentTR = user.TR;
    studentName = user.Name;
    branch = user.Branch;
    gender = user.Gender;

    // Update welcome UI
    document.getElementById('studentName').innerText = studentName || 'Student';
    document.getElementById('welcomeText').innerText =
      `Fitness ${studentName} | ${branch.toUpperCase()} | ${gender.toUpperCase()}`;

    // Load workout plan
    loadStudentPlans(studentTR);

    // Load extra info (Darajah, Goal etc.)
    fetch(`/api/student-info/${studentTR}`, {
      method: 'GET',
      credentials: 'include' // ✅ Include cookies here too
    })
      .then(res => res.json())
      .then(data => {
        if (data.success) {
          document.getElementById('studentSlot').innerText = data.student.Slot;
          document.getElementById('studentDarajah').innerText = data.student.Darajah;
          document.getElementById('studentGoal').innerText = `🎯 Goal: ${data.student.Goal}`;
          document.getElementById('studentTR').innerText = studentTR;
          loadTip(data.student.Goal);
        } else {
          alert('Student info not found.');
        }
      });

  } catch (err) {
    console.error('Error fetching student session:', err);
    window.location.href = 'Forbidden.html';
  }
}



window.addEventListener('DOMContentLoaded', getStudentSession);


function loadAttendance() {
        const selectedWeek = document.getElementById('weekSelect').value;
        if (!selectedWeek) {
            alert('Please select a week.');
            return;
        }

        weekId = selectedWeek; // update weekId to selected value

        fetch(`/api/student-attendance/${weekId}/${studentTR}`)
            .then(res => res.json())
            .then(data => {
                const tbody = document.querySelector('#attendanceTable tbody');
                tbody.innerHTML = '';

                if (data.length > 0) {
                    const student = data[0];
                    let totalDays = 7;
                    let presentDays = 0;
                    presentDays += student.Monday ? 1 : 0;
                    presentDays += student.Tuesday ? 1 : 0;
                    presentDays += student.Wednesday ? 1 : 0;
                    presentDays += student.Thursday ? 1 : 0;
                    presentDays += student.Friday ? 1 : 0;
                    presentDays += student.Saturday ? 1 : 0;
                    presentDays += student.Sunday ? 1 : 0;

                    const attendanceRate = Math.round((presentDays / totalDays) * 100);
                    const row = document.createElement('tr');

                    row.innerHTML = `
                        <td>${student.TR}</td>
                        <td>${student.Name}</td>
                        <td class="${student.Monday ? 'present' : 'absent'}">${student.Monday || 'Absent'}</td>
                        <td class="${student.Tuesday ? 'present' : 'absent'}">${student.Tuesday || 'Absent'}</td>
                        <td class="${student.Wednesday ? 'present' : 'absent'}">${student.Wednesday || 'Absent'}</td>
                        <td class="${student.Thursday ? 'present' : 'absent'}">${student.Thursday || 'Absent'}</td>
                        <td class="${student.Friday ? 'present' : 'absent'}">${student.Friday || 'Absent'}</td>
                        <td class="${student.Saturday ? 'present' : 'absent'}">${student.Saturday || 'Absent'}</td>
                        <td class="${student.Sunday ? 'present' : 'absent'}">${student.Sunday || 'Absent'}</td>
                    `;

                    tbody.appendChild(row);
                }
            });


        }

async function loadStudentPlans() {
  try {
    const res = await fetch('/api/student/training-plans', {
      method: 'GET',
      credentials: 'include' // ✅ include session cookies
    });

    const data = await res.json();

    if (data.success && data.data.length > 0) {
      renderTrainingPlans(data.data); // ✅ render to table
    } else {
      console.warn('No plans found:', data.message);
    }
  } catch (err) {
    console.error('Error loading training plans:', err);
  }
}

// ✅ Render table rows dynamically
function renderTrainingPlans(plans) {
  const tbody = document.querySelector('#studentPlanTable tbody');
  tbody.innerHTML = ''; // Clear previous

  plans.forEach(plan => {
    const tr = document.createElement('tr');

    const dateTd = document.createElement('td');
    dateTd.textContent = plan.LogDate;

    const partsTd = document.createElement('td');
    partsTd.textContent = plan.BodyParts;

    tr.appendChild(dateTd);
    tr.appendChild(partsTd);

    tbody.appendChild(tr);
  });
}

window.addEventListener('DOMContentLoaded', loadStudentPlans);


        function loadTip(goal) {
                let tip = "Stay active and hydrated!";
                if (goal.includes('Fat Loss')) tip = "Focus on high-protein, low-carb meals.";
                else if (goal.includes('Muscle Gain')) tip = "Increase protein intake and lift heavy!";
                else if (goal.includes('Endurance')) tip = "Practice steady cardio sessions.";

                document.getElementById('tipArea').innerText = tip;
                    }


//------------------------------------------------------------------------------


  function loadTip(goal) {
    let title = "💡 General Tip";
    let html = "Stay active and hydrated!";
    let video = "";

    if (goal.includes('Fat Loss')) {
      title = "🔥 Fat Loss Guide";
      html = `
        <ul>
          <li>Focus on high-protein, low-carb meals.</li>
          <li>Try HIIT (High Intensity Interval Training) workouts.</li>
          <li>Get enough sleep to support fat metabolism.</li>
        </ul>
        <p><strong>Starter Workout:</strong></p>
        <iframe width="100%" height="100%" src="https://www.youtube.com/embed/ml6cT4AZdqI" frameborder="0" allowfullscreen></iframe>
      `;
    } else if (goal.includes('Muscle Gain')) {
      title = "💪 Muscle Gain Tips";
      html = `
        <ul>
          <li>Increase protein intake (2g per kg bodyweight).</li>
          <li>Train each muscle group 2x per week with progressive overload.</li>
          <li>Rest well—recovery is key for growth.</li>
        </ul>
        <p><strong>Starter Workout:</strong></p>
        <iframe width="100%" height="100%" src="https://www.youtube.com/embed/XpP1gZzDMHY" frameborder="0" allowfullscreen></iframe>
      `;
    } else if (goal.includes('Fitness') || goal.includes('Endurance')) {
      title = "🏃 Fitness Boost";
      html = `
        <ul>
          <li>Do steady cardio 3–4x/week (e.g., jogging, cycling).</li>
          <li>Add bodyweight strength training for all-around performance.</li>
          <li>Focus on flexibility and mobility too!</li>
        </ul>
        <p><strong>Starter Workout:</strong></p>
        <iframe width="100%" height="100%" src="https://www.youtube.com/embed/3p8EBPVZ2Iw" frameborder="0" allowfullscreen></iframe>
      `;
    }



    // Also update the basic area (for fallback)
    document.getElementById('tipArea').innerHTML = html;
    document.getElementById('tips-low').style.display = 'block';
  }

//--------------------------------------------------------------------------------

const partTips = {
  "Cardio": {
    desc: "Cardio helps burn calories and improve heart health. Aim for 20–30 minutes of moderate to high-intensity cardio, 3–5 times per week.",
    exercises: [
      { name: "Treadmill Running", img: "https://www.inspireusafoundation.org/wp-content/uploads/2023/03/treadmill-run.gif" },
      { name: "Jump Rope", img: "https://media.tenor.com/xU-F2sMDcDkAAAAC/jump-rope.gif" }
    ]
  },
  "Chest": {
    desc: "Chest exercises develop your pectoral muscles and improve upper body strength. Include both pressing and fly movements.",
    exercises: [
      { name: "Bench Press", img: "https://www.inspireusafoundation.org/wp-content/uploads/2022/12/barbell-bench-press.gif" },
      { name: "Chest Fly", img: "https://www.inspireusafoundation.org/wp-content/uploads/2022/11/cable-crossover.gif" }
    ]
  },
  "Back": {
    desc: "Back training improves posture and builds pulling strength. Mix vertical and horizontal pulling exercises.",
    exercises: [
      { name: "Pull-Ups", img: "https://www.inspireusafoundation.org/wp-content/uploads/2023/03/pull-up.gif" },
      { name: "Bent-over Row", img: "https://www.inspireusafoundation.org/wp-content/uploads/2023/03/bent-over-barbell-row.gif" }
    ]
  },
  "Shoulders": {
    desc: "Target all three deltoid heads (front, side, rear) for well-rounded shoulder strength.",
    exercises: [
      { name: "Shoulder Press", img: "https://www.inspireusafoundation.org/wp-content/uploads/2022/11/barbell-overhead-press.gif" },
      { name: "Lateral Raise", img: "https://www.inspireusafoundation.org/wp-content/uploads/2022/12/dumbbell-lateral-raise.gif" }
    ]
  },
  "Biceps": {
    desc: "Biceps curls and pulling movements help build strong, toned arms.",
    exercises: [
      { name: "Barbell Curl", img: "https://www.inspireusafoundation.org/wp-content/uploads/2023/03/barbell-curl.gif" },
      { name: "Hammer Curl", img: "https://www.inspireusafoundation.org/wp-content/uploads/2022/11/dumbbell-hammer-curl.gif" }
    ]
  },
  "Triceps": {
    desc: "Triceps are key for arm size and pushing strength. Use isolation and compound lifts.",
    exercises: [
      { name: "Triceps Pushdown", img: "https://www.inspireusafoundation.org/wp-content/uploads/2023/03/triceps-pushdown.gif" },
      { name: "Overhead Extension", img: "https://www.inspireusafoundation.org/wp-content/uploads/2022/12/dumbbell-overhead-triceps-extension.gif" }
    ]
  },
  "Legs": {
    desc: "Leg training builds strength, balance, and coordination. Include squats, lunges, and deadlifts.",
    exercises: [
      { name: "Squats", img: "https://www.inspireusafoundation.org/wp-content/uploads/2022/11/barbell-squat.gif" },
      { name: "Lunges", img: "https://www.inspireusafoundation.org/wp-content/uploads/2023/03/dumbbell-lunge.gif" }
    ]
  },
  "Core": {
    desc: "Core workouts improve stability, posture, and total-body strength. Mix planks, crunches, and rotational moves.",
    exercises: [
      { name: "Plank", img: "https://www.inspireusafoundation.org/wp-content/uploads/2023/03/elbow-plank.gif" },
      { name: "Russian Twist", img: "https://www.inspireusafoundation.org/wp-content/uploads/2022/12/russian-twist.gif" }
    ]
  }
};

function loadBodyPartTips() {
  const value = document.getElementById("bodyPartSelect").value;
  const target = document.getElementById("bodyPartTips");
  target.innerHTML = "";

  if (!value || !partTips[value]) return;

  const { desc, exercises } = partTips[value];
  let html = `<p>${desc}</p><div class="row">`;

  exercises.forEach(ex => {
    html += `
      <div class="col-md-6 col-lg-4 mb-3">
        <div class="card h-100 shadow-sm">
          <img src="${ex.img}" class="card-img-top" alt="${ex.name}" loading="lazy">
          <div class="card-body">
            <h5 class="card-title">${ex.name}</h5>
          </div>
        </div>
      </div>
    `;
  });

  html += `</div>`;
  target.innerHTML = html;
}



//--------------------------------------------------------------------------------


    function formatDate(dateString) {
        const options = { weekday: 'short', month: 'short', day: 'numeric' };
        return new Date(dateString).toLocaleDateString(undefined, options);
    }

    // Function to load weeks from the API
    function loadWeeks() {
        fetch('/api/weeks')
            .then(res => res.json())
            .then(data => {
                const weekSelect = document.getElementById('weekSelect');
                weekSelect.innerHTML = '<option value="" disabled selected>Select Range</option>'; // Reset dropdown

                if (data.success && data.weeks.length > 0) {
                    data.weeks.forEach(week => {
                        const option = document.createElement('option');
                        option.value = week.WeekID;

                        // Format dates directly, without adding time
                        const startFormatted = formatDate(week.WeekStartDate);
                        const endFormatted = formatDate(week.WeekEndDate);

                        option.text = `(${startFormatted} → ${endFormatted})`;

                        weekSelect.appendChild(option);
                    });
                }
            })
            .catch(err => {
                console.error('Failed to load weeks:', err);
            });
    }

//----------------------------------------------------------------------------------------------------------

document.addEventListener('DOMContentLoaded', async () => {
  const studentTR = localStorage.getItem('studentTR');
  if (!studentTR) return;

  try {
    const res = await fetch(`/api/workout-log/${studentTR}`);
    const result = await res.json();

    const tbody = document.querySelector('#history-table tbody');
    tbody.innerHTML = '';

    if (result.success && result.data.length > 0) {
      result.data.forEach(log => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${new Date(log.LogDate).toLocaleString()}</td>
          <td>${log.MachineName}</td>
          <td>${log.Value}</td>
        `;
        tbody.appendChild(row);
      });
    } else {
      tbody.innerHTML = `<tr><td colspan="3" class="text-center">No workout history yet.</td></tr>`;
    }
  } catch (err) {
    console.error('Failed to load workout history:', err);
  }
});

//----------------------------------------------------------------------------------------------------------

function savePlan() {
  const cards = document.querySelectorAll('.day-card');
  const plan = {};

  cards.forEach(card => {
    const day = card.getAttribute('data-day');
    const content = card.innerHTML.trim();
    plan[day] = content;
  });

  fetch('/save-workout-plan', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(plan)
  })
    .then(res => {
      if (!res.ok) throw new Error('Server error');
      return res.json();
    })
    .then(data => {
      if (data.success) {
        Swal.fire({
          icon: 'success',
          title: 'Workout Plan Saved!',
          text: 'Your weekly plan was saved successfully.',
          timer: 2000,
          showConfirmButton: false
        });
      } else {
        Swal.fire({
          icon: 'error',
          title: 'Save Failed',
          text: 'Please try again.',
        });
      }
    })
    .catch(err => {
      console.error(err);
      Swal.fire({
        icon: 'error',
        title: 'Network Error',
        text: 'Could not save. Check your connection.',
      });
    });
}


async function loadWeeklyPlan() {
  try {
    const res = await fetch('/api/student/workout-plan', {
      method: 'GET',
      credentials: 'include'
    });

    const data = await res.json();

    if (data.success && Array.isArray(data.data)) {
      if (data.data.length === 0) {
        console.warn('No plan for current week.');
        document.getElementById('applyLastWeekBtn').style.display = 'inline-block';
      } else {
        data.data.forEach(entry => {
          const card = document.querySelector(`.day-card[data-day="${entry.Day}"]`);
          if (card) {
            card.innerHTML = entry.Content || '';
          }
        });
      }
    } else {
      console.warn('Invalid response from workout plan API:', data.message);
    }
  } catch (err) {
    console.error('Error loading workout plan:', err);
  }
}

window.addEventListener('DOMContentLoaded', loadWeeklyPlan);


function showApplyLastWeekButton() {
  document.getElementById('applyLastWeekBtn').style.display = 'block';
}

async function applyLastWeekPlan() {
  try {
    const res = await fetch('/api/student/apply-last-week', {
      method: 'POST',
      credentials: 'include'
    });

    const data = await res.json();

    if (data.success) {
      Swal.fire({
        icon: 'success',
        title: 'Applied!',
        text: 'Last week’s plan copied to this week.',
        timer: 2000,
        showConfirmButton: false
      });
      loadWorkoutPlan();
    } else {
      Swal.fire({
        icon: 'warning',
        title: 'Could not apply',
        text: data.message || 'Something went wrong.',
      });
    }

  } catch (err) {
    console.error('Apply last week failed:', err);
    Swal.fire({
      icon: 'error',
      title: 'Network Error',
      text: 'Could not apply last week’s plan.',
    });
  }
}


async function applyLastWeeksPlan() {
  try {
    const res = await fetch('/api/student/apply-last-week', {
      method: 'POST',
      credentials: 'include'
    });

    const data = await res.json();

    if (data.success) {
      Swal.fire({
        icon: 'success',
        title: 'Applied!',
        text: 'Last week’s plan applied successfully.',
        timer: 2000,
        showConfirmButton: false
      });
      loadWeeklyPlan();
    } else {
      Swal.fire({
        icon: 'warning',
        title: 'Apply Failed',
        text: data.message || 'Could not apply last week’s plan.',
      });
    }
  } catch (err) {
    console.error('Error applying last week’s plan:', err);
    Swal.fire({
      icon: 'error',
      title: 'Network Error',
      text: 'Failed to apply last week’s plan.',
    });
  }
}

 //----------------------------------------------------------------------------------------------------------

  
      // Trigger record load when dashboard loads
      document.getElementById('planner-main').addEventListener('click', () => {
        document.getElementById('attendance-low').style.display = 'none';
         document.getElementById('tips-low').style.display = 'none';
          document.getElementById('logs-low').style.display = 'none';
        document.getElementById('planner-low').style.display = 'block';
        loadStudentRecords();
      });
  
      document.getElementById('tips-main').addEventListener('click', () => {
        document.getElementById('attendance-low').style.display = 'none';
         document.getElementById('logs-low').style.display = 'none';
          document.getElementById('planner-low').style.display = 'none';
        document.getElementById('tips-low').style.display = 'block';
      });

      document.getElementById('attendance-main').addEventListener('click', () => {
  document.getElementById('planner-low').style.display = 'none';
  document.getElementById('logs-low').style.display = 'none';
   document.getElementById('tips-low').style.display = 'none';
  document.getElementById('attendance-low').style.display = 'block';
});

      document.getElementById('logs-main').addEventListener('click', () => {
  document.getElementById('planner-low').style.display = 'none';
  document.getElementById('attendance-low').style.display = 'none';
  document.getElementById('tips-low').style.display = 'none';
  document.getElementById('logs-low').style.display = 'block';
});





//----------------------------------------------------------------------------------------------------------

// Call this when page loads
window.onload = function() {
    loadWeeks();
};

function logout() {
        localStorage.clear();
        window.location.href = 'homepage.html';
    }


  

</script>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Quill JS -->
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
